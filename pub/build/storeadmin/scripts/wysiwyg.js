/*!
 * @preserve Generated by nwayo 3.4.2 for PROJECT_NAME:storeadmin
 */
!function(e,t){var n={nwayo:"3.4.2",project:"PROJECT_NAME",bundle:"storeadmin",konstan:{dimension:{small:600,medium:900,large:1200,xlarge:1500,xsmall:450,nav:750,max:1500},transition:{hover:100,ui:300,animation:500},color:{black:"#000000",white:"#ffffff","gray-light":"#f3f3f3","brand-sockeye":"#ff5252","brand-victoria":"#2b2d3c","main-cold-water":"#3c475d","main-cold-water-alt":"#808a9f",myst:"#b1c0c7",greyhound:"#68738b",toundra:"#e2e9ed","white-rabbit-in-the-snow":"#f2f6f7",success:"#4fb980",warning:"#ffd061",error:"#d66161","review-star":"#fecf8b"},font:{},util:{emptyimage:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},path:{root:"/build/storeadmin",fonts:"/build/storeadmin/fonts",icons:"/build/storeadmin/icons",images:"/build/storeadmin/images",raw:"/build/storeadmin/raw",scripts:"/build/storeadmin/scripts",styles:"/build/storeadmin/styles"}}};e.nwayo={konstan:n.konstan,project:n.project,bundle:n.bundle,version:n.nwayo},define(["jquery","underscore","tinymce","mage/adminhtml/wysiwyg/tiny_mce/html5-schema","mage/translate","prototype","mage/adminhtml/events","mage/adminhtml/browser"],function(e,n,i,o){window.tinyMceWysiwygSetup=Class.create(),tinyMceWysiwygSetup.prototype={mediaBrowserOpener:null,mediaBrowserTargetElementId:null,initialize:function(e,t){t.baseStaticUrl&&t.baseStaticDefaultUrl&&(i.baseURL=i.baseURL.replace(t.baseStaticUrl,t.baseStaticDefaultUrl)),this.id=e,this.config=t,this.schema=t.schema||o,n.bindAll(this,"beforeSetContent","saveContent","onChangeContent","openFileBrowser","updateTextArea"),varienGlobalEvents.attachEventHandler("tinymceChange",this.onChangeContent),varienGlobalEvents.attachEventHandler("tinymceBeforeSetContent",this.beforeSetContent),varienGlobalEvents.attachEventHandler("tinymceSetContent",this.updateTextArea),varienGlobalEvents.attachEventHandler("tinymceSaveContent",this.saveContent),"undefined"==typeof tinyMceEditors&&(window.tinyMceEditors=$H({})),tinyMceEditors.set(this.id,this)},setup:function(t){this.config.widget_plugin_src&&i.PluginManager.load("magentowidget",this.config.widget_plugin_src),this.config.plugins&&this.config.plugins.each(function(e){i.PluginManager.load(e.name,e.src)}),e.isReady&&(i.dom.Event.domLoaded=!0),i.init(this.getSettings(t))},getSettings:function(e){var n,i,o,s="inlinepopups,safari,pagebreak,style,layer,table,advhr,advimage,emotions,iespell,media,searchreplace,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras",a=this;return this.config.widget_plugin_src&&(s="magentowidget,"+s),n=$H({}),i="",this.config.plugins&&(this.config.plugins.each(function(e){i=e.name+","+i,n.set(e.name,e.options)}),i&&(s="-"+i+s)),(o={entity_encoding:"raw",mode:e!=t?e:"none",elements:this.id,theme:"advanced",plugins:s,theme_advanced_buttons1:i+"magentowidget,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect,fontselect,fontsizeselect",theme_advanced_buttons2:"cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,forecolor,backcolor",theme_advanced_buttons3:"tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,iespell,media,advhr,|,ltr,rtl,|,fullscreen",theme_advanced_buttons4:"insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,pagebreak",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",valid_elements:this.schema.validElements.join(","),valid_children:this.schema.validChildren.join(","),theme_advanced_resizing:!0,theme_advanced_resize_horizontal:!1,convert_urls:!1,relative_urls:!1,content_css:this.config.content_css,custom_popup_css:this.config.popup_css,magentowidget_url:this.config.widget_window_url,magentoPluginsOptions:n,doctype:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">',setup:function(e){var t;e.onPreInit.add(a.onEditorPreInit.bind(a)),e.onInit.add(a.onEditorInit.bind(a)),e.onSubmit.add(function(e,t){varienGlobalEvents.fireEvent("tinymceSubmit",t)}),e.onPaste.add(function(e,t,n){varienGlobalEvents.fireEvent("tinymcePaste",n)}),e.onBeforeSetContent.add(function(e,t){varienGlobalEvents.fireEvent("tinymceBeforeSetContent",t)}),e.onSetContent.add(function(e,t){varienGlobalEvents.fireEvent("tinymceSetContent",t)}),e.onSaveContent.add(function(e,t){varienGlobalEvents.fireEvent("tinymceSaveContent",t)}),t=function(e,t){varienGlobalEvents.fireEvent("tinymceChange",t)},e.onChange.add(t),e.onKeyUp.add(t),e.onExecCommand.add(function(e,t){varienGlobalEvents.fireEvent("tinymceExecCommand",t)})}}).style_formats||(o.theme_advanced_buttons1=o.theme_advanced_buttons1.replace(",styleselect","")),this.config.document_base_url&&(o.document_base_url=this.config.document_base_url),this.config.files_browser_window_url&&(o.file_browser_callback=function(e,t,n,i){varienGlobalEvents.fireEvent("open_browser_callback",{win:i,type:n,field:e})}),this.config.width&&(o.width=this.config.width),this.config.height&&(o.height=this.config.height),this.config.settings&&Object.extend(o,this.config.settings),window._custom_tinymce_settings&&(o=window._custom_tinymce_settings(o)),o},applySchema:function(t){var n=t.schema,o=this.schema,s=i.makeMap;e.extend(!0,{nonEmpty:n.getNonEmptyElements(),boolAttrs:n.getBoolAttrs(),whiteSpace:n.getWhiteSpaceElements(),shortEnded:n.getShortEndedElements(),selfClosing:n.getSelfClosingElements(),blockElements:n.getBlockElements()},{nonEmpty:s(o.nonEmpty),boolAttrs:s(o.boolAttrs),whiteSpace:s(o.whiteSpace),shortEnded:s(o.shortEnded),selfClosing:s(o.selfClosing),blockElements:s(o.blockElements)})},openFileBrowser:function(t){var n,i=null!==this.config.store_id?this.config.store_id:0,o=e(t.win.frameElement).parents('[role="dialog"]'),s=this.config.files_browser_window_url+"target_element_id/"+this.id+"/store/"+i+"/";this.mediaBrowserOpener=t.win,this.mediaBrowserTargetElementId=t.field,void 0!==t.type&&""!=t.type?(n="image"==t.type?this.translate("Insert Image..."):this.translate("Insert Media..."),s=s+"type/"+t.type+"/"):n=this.translate("Insert File..."),o.hide(),e("#mceModalBlocker").hide(),MediabrowserUtility.openDialog(s,!1,!1,n,{closed:function(){o.show(),e("#mceModalBlocker").show()}})},translate:function(t){return e.mage.__?e.mage.__(t):t},getMediaBrowserOpener:function(){return this.mediaBrowserOpener},getMediaBrowserTargetElementId:function(){return this.mediaBrowserTargetElementId},getToggleButton:function(){return $("toggle"+this.id)},getPluginButtons:function(){return $$("#buttons"+this.id+" > button.plugin")},turnOn:function(e){return this.closePopups(),this.setup(e),i.execCommand("mceAddControl",!1,this.id),this.getPluginButtons().each(function(e){e.hide()}),this},turnOff:function(){return this.closePopups(),i.execCommand("mceRemoveControl",!1,this.id),this.getPluginButtons().each(function(e){e.show()}),this},closePopups:function(){"function"==typeof closeEditorPopup&&(closeEditorPopup("widget_window"+this.id),closeEditorPopup("browser_window"+this.id))},toggle:function(){return i.get(this.id)?(this.turnOff(),!1):(this.turnOn(),!0)},onEditorPreInit:function(e){this.applySchema(e)},onEditorInit:function(){},onFormValidation:function(){i.get(this.id)&&($(this.id).value=i.get(this.id).getContent())},onChangeContent:function(){var e;this.updateTextArea(),this.config.tab_id&&(e=$$("a[id$="+this.config.tab_id+"]")[0],$(e)!=t&&$(e).hasClassName("tab-item-link")&&$(e).addClassName("changed"))},makeDirectiveUrl:function(e){return this.config.directives_url.replace("directive","directive/___directive/"+e)},encodeDirectives:function(e){return e.gsub(/<([a-z0-9\-\_]+.+?)([a-z0-9\-\_]+=".*?\{\{.+?\}\}.*?".*?)>/i,function(e){var t=e[2];return t=t.gsub(/([a-z0-9\-\_]+)="(.*?)(\{\{.+?\}\})(.*?)"/i,function(e){return e[1]+'="'+e[2]+this.makeDirectiveUrl(Base64.mageEncode(e[3]))+e[4]+'"'}.bind(this)),"<"+e[1]+t+">"}.bind(this))},encodeWidgets:function(e){return e.gsub(/\{\{widget(.*?)\}\}/i,function(e){var t,n,i=this.parseAttributesString(e[1]);if(i.type)return i.type=i.type.replace(/\\\\/g,"\\"),t=this.config.widget_placeholders[i.type],n="<img",n+=' id="'+Base64.idEncode(e[0])+'"',n+=' src="'+t+'"',n+=' title="'+e[0].replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\"/g,"&quot;")+'"',n+=">"}.bind(this))},decodeDirectives:function(e){var t=this.makeDirectiveUrl("%directive%").replace(/([$^.?*!+:=()\[\]{}|\\])/g,"\\$1"),n=new RegExp(t.replace("%directive%","([a-zA-Z0-9,_-]+)"));return e.gsub(n,function(e){return Base64.mageDecode(e[1])})},decodeWidgets:function(e){return e.gsub(/<img([^>]+id=\"[^>]+)>/i,function(e){var t,n=this.parseAttributesString(e[1]);return n.id&&-1!==(t=Base64.idDecode(n.id)).indexOf("{{widget")?t:e[0]}.bind(this))},parseAttributesString:function(e){var t={};return e.gsub(/(\w+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/,function(e){t[e[1]]=e[2]}),t},updateTextArea:function(){var t,n=i.get(this.id);n&&(t=n.getContent(),t=this.decodeContent(t),e("#"+this.id).val(t).trigger("change"))},decodeContent:function(e){var t=e;return this.config.add_widgets?(t=this.decodeWidgets(t),t=this.decodeDirectives(t)):this.config.add_directives&&(t=this.decodeDirectives(t)),t},encodeContent:function(e){var t=e;return this.config.add_widgets?(t=this.encodeWidgets(t),t=this.encodeDirectives(t)):this.config.add_directives&&(t=this.encodeDirectives(t)),t},beforeSetContent:function(e){e.content=this.encodeContent(e.content)},saveContent:function(e){e.content=this.decodeContent(e.content)}}}),window._custom_tinymce_settings=function(e){"use strict";e.content_css=nwayo.konstan.path.styles+"/wysiwyg.css",e.style_formats=[{title:"Paragraphe (p)",block:"p"},{title:"Sous-titre (h2)",block:"h2"},{title:"Sous-titre (h3)",block:"h3"},{title:"Sous-titre (h4)",block:"h4"}],e.template_templates=[{title:"1 Column",src:nwayo.konstan.path.raw+"/store-wysiwyg/1col.html",description:""},{title:"2 Columns",src:nwayo.konstan.path.raw+"/store-wysiwyg/2cols.html",description:""},{title:"3 Columns",src:nwayo.konstan.path.raw+"/store-wysiwyg/3cols.html",description:""},{title:"4 Columns",src:nwayo.konstan.path.raw+"/store-wysiwyg/4cols.html",description:""}];var t="";e.template_templates&&(e.plugins+=", template",t=",template");var n="";return e.style_formats&&(n="styleselect,"),e.theme_advanced_buttons1=e.theme_advanced_buttons1.replace("formatselect,fontselect,fontsizeselect",n+"removeformat,hr,table,|,sub,sup"),e.theme_advanced_buttons1=e.theme_advanced_buttons1.replace("underline,strikethrough","strikethrough"+t),e.theme_advanced_buttons2=e.theme_advanced_buttons2.replace(",|,forecolor,backcolor",""),e.theme_advanced_buttons3="",e.theme_advanced_buttons4="",e.forced_root_block="",e}}("undefined"!=typeof window?window:this);